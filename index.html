<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AYEDU AI HUB - AI-powered educational platform for Sri Lankan Advanced Level Technology students">
    <title>AYEDU AI HUB - ඔබේ අධ්‍යයන සාර්ථකත්වය, බුද්ධිමත් සහාය සමඟ</title>
    
    <!-- Original index.html styles and scripts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Custom Styles from original index.html (Crucial for AI Tool Modal) -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Fira+Code:wght@400;500&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&display=swap');
        
        body { font-family: 'Inter', sans-serif; }
        
        /* --- Existing Layout Styles (Unchanged) --- */
        .stat-item {
            text-align: center; margin-bottom: 20px; padding: 15px; border-radius: 10px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef); transition: all 0.3s ease;
        }
        .stat-item:hover { transform: translateY(-3px); box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); }
        .stat-item h3 { font-size: 2rem; color: #3498db; margin-bottom: 5px; font-weight: bold; }
        .stat-item p { color: #666; font-weight: 500; margin: 0; }
        
        .col-md-6 { flex: 1; padding: 0 15px; }
        .col-md-6 h4 { color: #2c3e50; margin-bottom: 10px; font-size: 1.1rem; }
        .col-md-6 ul { list-style: none; padding-left: 0; }
        .col-md-6 ul li {
            background-color: #ecf0f1; padding: 8px 15px; margin-bottom: 8px; border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); transition: transform 0.2s;
        }
        .col-md-6 ul li:hover { transform: translateX(5px); background-color: #dce0e1; }
        
        .main-content { display: flex; flex-wrap: wrap; padding: 20px 0; }
        
        .subject-card {
            background-color: white; padding: 20px; margin: 15px; border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); flex: 1 1 calc(33% - 30px); min-width: 280px;
            text-align: center; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer;
        }
        .subject-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15); }
        .subject-card i { font-size: 3rem; color: #3498db; margin-bottom: 10px; transition: all 0.3s ease; }
        .subject-card:hover i { transform: scale(1.1); color: #2980b9; }
        .subject-card h3 { color: #2c3e50; font-size: 1.5rem; margin-bottom: 5px; }
        
        .header {
            background: linear-gradient(135deg, #0d47a1 0%, #1565c0 100%); color: white; padding: 24px 0;
            box-shadow: 0 6px 15px -3px rgba(0, 0, 0, 0.2); border-bottom-left-radius: 12px; border-bottom-right-radius: 12px; text-align: center;
        }
        .navbar { background-color: #2c3e50; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); }

        /* Modal Styles */
        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%;
            overflow: hidden; background-color: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
            align-items: center; justify-content: center;
        }
        .modal-content-custom {
            background-color: #fefefe; margin: auto; padding: 0; border-radius: 20px;
            width: 95%; max-width: 900px; height: 85vh; /* Fixed height for consistent look */
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); position: relative;
            display: flex; flex-direction: column; overflow: hidden; animation: zoomIn 0.3s ease-out;
        }
        @keyframes zoomIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* --- Tool Specific Themes --- */
        
        /* 1. Chat Theme */
        .theme-chat-bg { background-color: #f0f2f5; background-image: url('https://www.transparenttextures.com/patterns/subtle-white-feathers.png'); }
        .chat-bubble { max-width: 80%; padding: 10px 15px; border-radius: 20px; margin-bottom: 8px; font-size: 0.95rem; line-height: 1.4; }
        .chat-user { background: #0084ff; color: white; border-bottom-right-radius: 4px; align-self: flex-end; margin-left: auto; }
        .chat-ai { background: white; color: #1c1e21; border-bottom-left-radius: 4px; align-self: flex-start; border: 1px solid #ddd; }

        /* 2. Code Theme */
        .theme-code-bg { background-color: #1e1e1e; color: #d4d4d4; font-family: 'Fira Code', monospace; }
        .code-input { background-color: #2d2d2d; border: 1px solid #3e3e3e; color: #9cdcfe; font-family: 'Fira Code', monospace; }
        .code-output { background-color: #252526; border-left: 3px solid #0e639c; color: #ce9178; }

        /* 3. Paper/Essay Theme */
        .theme-paper-bg { background-color: #f3f4f6; }
        .paper-sheet { background: white; padding: 40px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); font-family: 'Merriweather', serif; line-height: 1.8; color: #2c3e50; }
        .paper-input { border: none; border-bottom: 2px solid #e5e7eb; background: transparent; font-family: 'Inter', sans-serif; }

        /* 4. Audio Theme */
        .theme-audio-bg { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); color: white; }
        .audio-visualizer { display: flex; align-items: center; justify-content: center; height: 60px; gap: 4px; }
        .audio-bar { width: 6px; background: rgba(255,255,255,0.6); border-radius: 3px; animation: bounce 1s infinite ease-in-out; }
        @keyframes bounce { 0%, 100% { height: 10px; } 50% { height: 40px; } }

        /* 5. Sticky Note Theme (Idea Generator) */
        .theme-sticky-bg { background-color: #fff7ed; background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 20px 20px; }
        .sticky-note { background: #fef08a; padding: 15px; box-shadow: 3px 3px 10px rgba(0,0,0,0.1); transform: rotate(-1deg); font-family: 'Kalam', cursive; border-top: 1px solid rgba(255,255,255,0.5); }
        .sticky-note:nth-child(even) { background: #bfdbfe; transform: rotate(1deg); }
        .sticky-note:nth-child(3n) { background: #bbf7d0; transform: rotate(-2deg); }

        /* Tool Grid & Icons */
        .ai-tool-btn { transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); min-height: 100px; }
        .ai-tool-btn:hover { transform: translateY(-5px); }
        
        /* Custom Scrollbar for Tool Content */
        .custom-scroll::-webkit-scrollbar { width: 8px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        @media (max-width: 768px) {
            #aiToolButtons { grid-template-columns: repeat(2, 1fr); }
            .nav-list { display: none; }
            .modal-content-custom { width: 100%; height: 100%; border-radius: 0; }
        }
        
        /* New styles from pasted_content.txt for better design integration */
        .container-custom { max-width: 1280px; margin-left: auto; margin-right: auto; padding-left: 1rem; padding-right: 1rem; }
        .bg-primary { background-color: #1e40af; } /* Dark Blue */
        .bg-primary-800 { background-color: #1e3a8a; }
        .bg-secondary { background-color: #059669; } /* Green */
        .bg-accent { background-color: #f59e0b; } /* Amber/Orange */
        .text-accent { color: #f59e0b; }
        .btn-accent { background-color: #f59e0b; color: white; }
        .btn-accent:hover { background-color: #d97706; }
        .card { background-color: white; border-radius: 0.75rem; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1); }
        .section { padding-top: 4rem; padding-bottom: 4rem; }
        .text-gradient { background-image: linear-gradient(to right, #f59e0b, #fcd34d); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Navigation Header (From pasted_content.txt) -->
    <header class="bg-primary shadow-lg sticky top-0 z-50">
        <nav class="container-custom">
            <div class="flex items-center justify-between py-4">
                <!-- Logo -->
                <a href="index.html" class="flex items-center gap-3 group">
                    <div class="w-12 h-12 bg-accent rounded-full flex items-center justify-center transform group-hover:scale-110 transition-transform duration-300">
                        <i class="fas fa-globe text-white text-xl"></i>
                    </div>
                    <div class="flex flex-col">
                        <span class="text-white font-bold text-2xl leading-none">AYEDU</span>
                        <span class="text-accent-200 text-xs font-medium">AI HUB</span>
                    </div>
                </a>

                <!-- Desktop Navigation -->
                <div class="hidden lg:flex items-center gap-8">
                    <a href="index.html" class="text-white font-semibold border-b-2 border-accent pb-1 hover:text-accent-200 transition-colors">මුල් පිටුව</a>
                    <a href="#ai-tools-section" class="text-white hover:text-accent-200 transition-colors">AI මෙවලම්</a>
                    <a href="#subject-categories" class="text-white hover:text-accent-200 transition-colors">විෂය කාණ්ඩ</a>
                    <a href="#learning-dashboard" class="text-white hover:text-accent-200 transition-colors">ඉගෙනුම් පුවරුව</a>
                    <a href="#resource-library" class="text-white hover:text-accent-200 transition-colors">සම්පත් පුස්තකාලය</a>
                    <a href="login.html" class="text-white hover:text-accent-200 transition-colors">මගේ ගිණුම</a>
                </div>

                <!-- Search & Profile -->
                <div class="hidden lg:flex items-center gap-4">
                    <div class="relative">
                        <input type="text" placeholder="සොයන්න..." id="searchInput" class="px-3 py-2 pl-10 pr-4 w-64 bg-primary-800 border-primary-700 text-white placeholder-primary-300 focus:ring-accent-500 rounded-lg">
                        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-primary-300"></i>
                    </div>
                    <a href="login.html" class="btn btn-accent btn-sm">
                        <i class="fas fa-user mr-2"></i>
                        පිවිසෙන්න
                    </a>
                </div>

                <!-- Mobile Menu Button -->
                <button class="lg:hidden text-white text-2xl" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <!-- Mobile Navigation -->
            <div id="mobileMenu" class="hidden lg:hidden pb-4">
                <div class="flex flex-col gap-3">
                    <a href="index.html" class="text-white font-semibold bg-primary-800 px-4 py-2 rounded-lg">මුල් පිටුව</a>
                    <a href="#ai-tools-section" class="text-white hover:bg-primary-800 px-4 py-2 rounded-lg transition-colors">AI මෙවලම්</a>
                    <a href="#subject-categories" class="text-white hover:bg-primary-800 px-4 py-2 rounded-lg transition-colors">විෂය කාණ්ඩ</a>
                    <a href="#learning-dashboard" class="text-white hover:bg-primary-800 px-4 py-2 rounded-lg transition-colors">ඉගෙනුම් පුවරුව</a>
                    <a href="#resource-library" class="text-white hover:bg-primary-800 px-4 py-2 rounded-lg transition-colors">සම්පත් පුස්තකාලය</a>
                    <a href="login.html" class="text-white hover:bg-primary-800 px-4 py-2 rounded-lg transition-colors">මගේ ගිණුම</a>
                    <div class="relative mt-2">
                        <input type="text" placeholder="සොයන්න..." class="input py-2 pl-10 pr-4 w-full bg-primary-800 border-primary-700 text-white placeholder-primary-300 rounded-lg">
                        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-primary-300"></i>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Hero Section (From pasted_content.txt) -->
    <section class="section-hero bg-gradient-to-br from-primary via-primary-800 to-secondary relative overflow-hidden">
        <div class="absolute inset-0 opacity-10">
            <div class="absolute top-0 left-0 w-96 h-96 bg-accent rounded-full blur-3xl"></div>
            <div class="absolute bottom-0 right-0 w-96 h-96 bg-primary-400 rounded-full blur-3xl"></div>
        </div>
        
        <div class="container-custom relative z-10 py-20">
            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <div class="text-white animate-fade-in">
                    <div class="inline-flex items-center gap-2 bg-accent/20 backdrop-blur-sm px-4 py-2 rounded-full mb-6">
                        <i class="fas fa-star text-accent"></i>
                        <span class="text-sm font-medium">2025 හි #1 අධ්‍යාපන වේදිකාව</span>
                    </div>
                    <h1 class="text-5xl lg:text-6xl font-bold mb-6 leading-tight">
                        ඔබේ අධ්‍යයන සාර්ථකත්වය,<br>
                        <span class="text-gradient">බුද්ධිමත් සහාය සමඟ</span>
                    </h1>
                    <p class="text-xl text-primary-100 mb-8 leading-relaxed">
                        Advanced Level තාක්ෂණ විද්‍යා සිසුන් සඳහා AI බලයෙන් යුත් සම්පූර්ණ අධ්‍යාපන පරිසරයක්. සාම්ප්‍රදායික ඉගෙනුම සම්පත් නවීන AI මෙවලම් සමඟ ඒකාබද්ධ කරමින්.
                    </p>
                    <div class="flex flex-wrap gap-4">
                        <a href="#ai-tools-section" class="btn btn-accent btn-lg px-6 py-3 rounded-lg font-bold">
                            <i class="fas fa-rocket mr-2"></i>
                            AI මෙවලම් අත්හදා බලන්න
                        </a>
                        <a href="#subject-categories" class="btn btn-outline btn-lg border-white text-white hover:bg-white hover:text-primary px-6 py-3 rounded-lg font-bold">
                            <i class="fas fa-book mr-2"></i>
                            විෂය ගවේෂණය කරන්න
                        </a>
                    </div>

                    <!-- Quick Stats (Original index.html stats integrated into new design) -->
                    <div class="grid grid-cols-3 gap-6 mt-12 pt-8 border-t border-primary-700">
                        <div>
                            <div class="text-3xl font-bold text-accent mb-1" id="filesCount">150+</div>
                            <div class="text-sm text-primary-200">ගොනු ප්‍රමාණය</div>
                        </div>
                        <div>
                            <div class="text-3xl font-bold text-accent mb-1" id="usersCount">2.5K+</div>
                            <div class="text-sm text-primary-200">ලියාපදිංචි පරිශීලකයින්</div>
                        </div>
                        <div>
                            <div class="text-3xl font-bold text-accent mb-1" id="downloadsCount">10K+</div>
                            <div class="text-sm text-primary-200">බාගත කිරීම්</div>
                        </div>
                    </div>
                </div>

                <div class="relative animate-slide-up">
                    <div class="relative z-10">
                        <img src="https://img.rocket.new/generatedImages/rocket_gen_img_1eef5ac88-1764578146564.png" 
                             alt="Sri Lankan students collaborating on technology projects with AI assistance" 
                             class="rounded-2xl shadow-2xl w-full h-auto object-cover"
                             onerror="this.src='https://images.pexels.com/photos/3184291/pexels-photo-3184291.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2'; this.onerror=null;">
                    </div>
                    <div class="absolute -bottom-6 -right-6 w-72 h-72 bg-accent/20 rounded-full blur-3xl"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container-custom mt-8">

        <!-- AI Tools Section (From original index.html, adapted to new design) -->
        <section id="ai-tools-section" class="section mb-12 p-6 bg-white rounded-xl shadow-2xl">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold text-text-primary mb-4">
                    <i class="fas fa-rocket mr-3 text-blue-700"></i> AYEDU AI HUB
                </h2>
                <p class="text-lg text-text-secondary max-w-2xl mx-auto">ඔබගේ අධ්‍යාපන කටයුතු පහසු කර ගැනීමට නිර්මාණය කරන ලද නවීනතම AI මෙවලම් මෙතැනින් තෝරන්න. (අත්හදා බැලීමේ සංස්කරණය)</p>
            </div>
            <div id="aiToolButtons" class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4">
                <!-- Rendered by JS -->
            </div>
        </section>

        <!-- Subject Categories (From pasted_content.txt) -->
        <section id="subject-categories" class="section bg-white rounded-xl shadow-2xl mb-12">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold text-text-primary mb-4">විෂය කාණ්ඩ</h2>
                <p class="text-lg text-text-secondary max-w-2xl mx-auto">ඔබේ විෂය ධාරාවට අදාළ සියලුම සම්පත් සහ මෙවලම් සොයා ගන්න</p>
            </div>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Subject Card 1: Engineering Technology -->
                <a href="et.html" class="card card-hover group text-center">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
                        <i class="fas fa-cogs text-blue-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-text-primary mb-2">ඉංජිනේරු තාක්ෂණවේදය</h3>
                    <p class="text-text-secondary">යාන්ත්‍රික, සිවිල් සහ විදුලි ඉංජිනේරු විද්‍යාව</p>
                </a>
                <!-- Subject Card 2: Science for Technology -->
                <a href="sft.html" class="card card-hover group text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
                        <i class="fas fa-flask text-green-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-text-primary mb-2">තාක්ෂණවේදය සදහා විද්‍යාව</h3>
                    <p class="text-text-secondary">භෞතික විද්‍යාව, රසායන විද්‍යාව සහ ජීව විද්‍යාව</p>
                </a>
                <!-- Subject Card 3: ICT -->
                <a href="ict.html" class="card card-hover group text-center">
                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
                        <i class="fas fa-computer text-purple-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-text-primary mb-2">තොරතුරු සන්නිවේදන තාක්ෂණය</h3>
                    <p class="text-text-secondary">පරිගණක විද්‍යාව සහ මෘදුකාංග සංවර්ධනය</p>
                </a>
                <!-- Subject Card 4: General -->
                <a href="javascript:void(0)" class="card card-hover group text-center">
                    <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
                        <i class="fas fa-globe text-yellow-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-text-primary mb-2">සාමාන්‍ය සම්පත්</h3>
                    <p class="text-text-secondary">විභාග උපදෙස් සහ අධ්‍යයන ක්‍රම</p>
                </a>
            </div>
        </section>

        <!-- Learning Dashboard (From pasted_content.txt) -->
        <section id="learning-dashboard" class="section bg-white rounded-xl shadow-2xl mb-12">
            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <div class="order-2 lg:order-1">
                    <h2 class="text-4xl font-bold text-text-primary mb-4">ඔබේ ප්‍රගතිය නිරීක්ෂණය කරන්න</h2>
                    <p class="text-lg text-text-secondary mb-6">පුද්ගලීකරණය කළ ඉගෙනුම් පුවරුවක් සමඟින් ඔබේ අධ්‍යයන ගමන කළමනාකරණය කරන්න. ඔබේ දුර්වලතා හඳුනාගෙන ඒවා ශක්තිමත් කරන්න.</p>
                    <ul class="space-y-4 mb-8">
                        <li class="flex items-start gap-3">
                            <i class="fas fa-check-circle text-accent text-xl mt-1"></i>
                            <div>
                                <h4 class="font-semibold text-text-primary">විෂය ප්‍රවීණතා මට්ටම්</h4>
                                <p class="text-text-secondary text-sm">සෑම විෂයයකම ඔබේ දැනුම මට්ටම පැහැදිලිව බලන්න.</p>
                            </div>
                        </li>
                        <li class="flex items-start gap-3">
                            <i class="fas fa-chart-line text-accent text-xl mt-1"></i>
                            <div>
                                <h4 class="font-semibold text-text-primary">ප්‍රගති වාර්තා</h4>
                                <p class="text-text-secondary text-sm">සතිපතා සහ මාසික ප්‍රගති වාර්තා ලබා ගන්න.</p>
                            </div>
                        </li>
                        <li class="flex items-start gap-3">
                            <i class="fas fa-trophy text-accent text-xl mt-1"></i>
                            <div>
                                <h4 class="font-semibold text-text-primary">ඉලක්ක සැකසීම</h4>
                                <p class="text-text-secondary text-sm">ඔබේ ඉගෙනුම් ඉලක්ක සකසා ඒවා කරා ළඟා වන්න.</p>
                            </div>
                        </li>
                    </ul>
                    <a href="javascript:void(0)" class="btn btn-primary btn-lg px-6 py-3 rounded-lg font-bold">
                        ඉගෙනුම් පුවරුවට පිවිසෙන්න
                        <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
                <div class="order-1 lg:order-2">
                    <img src="https://img.rocket.new/generatedImages/rocket_gen_img_10826c7fd-1764578150154.png" 
                         alt="Learning Dashboard Screenshot" 
                         class="rounded-xl shadow-2xl w-full h-auto object-cover"
                         onerror="this.src='https://images.pexels.com/photos/4145354/pexels-photo-4145354.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2'; this.onerror=null;">
                </div>
            </div>
        </section>

        <!-- Resource Library (From pasted_content.txt) -->
        <section id="resource-library" class="section bg-white rounded-xl shadow-2xl mb-12">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold text-text-primary mb-4">සම්පත් පුස්තකාලය</h2>
                <p class="text-lg text-text-secondary max-w-2xl mx-auto">Past Papers, Short Notes, සහ Video Tutorials ඇතුළු 850+ අධ්‍යයන සම්පත්</p>
            </div>
            <div class="grid md:grid-cols-3 gap-6">
                <!-- Resource Card 1 -->
                <div class="card card-hover group">
                    <i class="fas fa-file-pdf text-error text-3xl mb-3"></i>
                    <h3 class="text-xl font-semibold text-text-primary mb-2">Past Papers</h3>
                    <p class="text-text-secondary mb-4">2010 සිට මේ දක්වා සියලුම විෂය ධාරාවල Past Papers සහ Marking Schemes.</p>
                    <a href="javascript:void(0)" class="text-primary font-medium group-hover:text-accent transition-colors">බාගත කරන්න <i class="fas fa-arrow-right ml-1 text-sm"></i></a>
                </div>
                <!-- Resource Card 2 -->
                <div class="card card-hover group">
                    <i class="fas fa-pencil-alt text-success text-3xl mb-3"></i>
                    <h3 class="text-xl font-semibold text-text-primary mb-2">Short Notes</h3>
                    <p class="text-text-secondary mb-4">විෂය නිර්දේශය ආවරණය වන පරිදි සකස් කළ කෙටි සටහන්.</p>
                    <a href="javascript:void(0)" class="text-primary font-medium group-hover:text-accent transition-colors">දැන්ම බලන්න <i class="fas fa-arrow-right ml-1 text-sm"></i></a>
                </div>
                <!-- Resource Card 3 -->
                <div class="card card-hover group">
                    <i class="fas fa-video text-primary text-3xl mb-3"></i>
                    <h3 class="text-xl font-semibold text-text-primary mb-2">Video Tutorials</h3>
                    <p class="text-text-secondary mb-4">සංකීර්ණ පාඩම් සඳහා පියවරෙන් පියවර වීඩියෝ පැහැදිලි කිරීම්.</p>
                    <a href="javascript:void(0)" class="text-primary font-medium group-hover:text-accent transition-colors">නරඹන්න <i class="fas fa-arrow-right ml-1 text-sm"></i></a>
                </div>
            </div>
        </section>

        <!-- Community Forum (From pasted_content.txt) -->
        <section id="community-forum" class="section bg-white rounded-xl shadow-2xl mb-12">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold text-text-primary mb-4">ක්‍රියාකාරී ප්‍රජාව</h2>
                <p class="text-lg text-text-secondary max-w-2xl mx-auto">අනෙකුත් සිසුන් සමඟ සම්බන්ධ වී, ප්‍රශ්න අසන්න, සහ දැනුම බෙදා ගන්න</p>
            </div>
            <div class="grid lg:grid-cols-2 gap-6">
                <!-- Forum Discussion 1 -->
                <div class="card card-hover cursor-pointer" onclick="window.location.href='javascript:void(0)'">
                    <div class="flex items-start gap-4">
                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=1974&auto=format&fit=crop" 
                             alt="Profile picture of forum discussion participant" 
                             class="w-12 h-12 rounded-full object-cover">
                        <div class="flex-1">
                            <h4 class="font-semibold text-text-primary mb-2">Object-Oriented Programming හි Inheritance සංකල්පය පැහැදිලි කරන්න පුළුවන්ද?</h4>
                            <p class="text-sm text-text-secondary mb-3">මම Java වලින් inheritance භාවිතා කරන විට ටිකක් අවුල් වෙනවා. කවුරුහරි උදාහරණ සමඟ පැහැදිලි කරන්න පුළුවන්ද?</p>
                            <div class="flex items-center gap-4 text-sm text-text-secondary">
                                <span class="flex items-center gap-1">
                                    <i class="fas fa-comments text-primary"></i>
                                    24 පිළිතුරු
                                </span>
                                <span class="flex items-center gap-1">
                                    <i class="fas fa-eye text-primary"></i>
                                    156 දැක්ම
                                </span>
                                <span>2 පැය පෙර</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Forum Discussion 2 -->
                <div class="card card-hover cursor-pointer" onclick="window.location.href='javascript:void(0)'">
                    <div class="flex items-start gap-4">
                        <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=1974&auto=format&fit=crop" 
                             alt="Profile picture of study group organizer" 
                             class="w-12 h-12 rounded-full object-cover">
                        <div class="flex-1">
                            <h4 class="font-semibold text-text-primary mb-2">Database Management සඳහා අධ්‍යයන කණ්ඩායමක් සංවිධානය කරමු</h4>
                            <p class="text-sm text-text-secondary mb-3">සතියකට දෙවරක් හවස 7ට online හමුවෙලා SQL queries සහ normalization practice කරමු. කැමති අය join වෙන්න.</p>
                            <div class="flex items-center gap-4 text-sm text-text-secondary">
                                <span class="flex items-center gap-1">
                                    <i class="fas fa-users text-success"></i>
                                    12 සාමාජිකයින්
                                </span>
                                <span class="flex items-center gap-1">
                                    <i class="fas fa-calendar text-success"></i>
                                    සඳුදා ආරම්භ වේ
                                </span>
                                <span class="badge badge-success">විවෘත</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-8">
                <a href="javascript:void(0)" class="btn btn-primary btn-lg px-6 py-3 rounded-lg font-bold">
                    ප්‍රජාවට එක් වන්න
                    <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>
        </section>

        <!-- Call to Action (From pasted_content.txt) -->
        <section class="section bg-gradient-to-br from-primary via-primary-800 to-secondary text-white relative overflow-hidden rounded-xl shadow-2xl mb-12">
            <div class="absolute inset-0 opacity-10">
                <div class="absolute top-0 right-0 w-96 h-96 bg-accent rounded-full blur-3xl"></div>
                <div class="absolute bottom-0 left-0 w-96 h-96 bg-primary-400 rounded-full blur-3xl"></div>
            </div>

            <div class="container-custom relative z-10">
                <div class="max-w-4xl mx-auto text-center">
                    <h2 class="text-4xl md:text-5xl font-bold mb-6">ඔබේ අධ්‍යාපන ගමන අද ආරම්භ කරන්න</h2>
                    <p class="text-xl text-primary-100 mb-8 max-w-2xl mx-auto">
                        12,500+ සිසුන් සමඟ එක් වී AI බලයෙන් යුත් ඉගෙනුමේ අනාගතය අත්විඳින්න
                    </p>
                    <div class="flex flex-wrap justify-center gap-4">
                        <a href="login.html" class="btn btn-accent btn-lg px-6 py-3 rounded-lg font-bold">
                            <i class="fas fa-user-plus mr-2"></i>
                            නොමිලේ ගිණුමක් සාදන්න
                        </a>
                        <a href="#ai-tools-section" class="btn btn-outline btn-lg border-white text-white hover:bg-white hover:text-primary px-6 py-3 rounded-lg font-bold">
                            <i class="fas fa-play-circle mr-2"></i>
                            AI මෙවලම් අත්හදා බලන්න
                        </a>
                    </div>
                </div>
            </div>
        </section>

    </div> <!-- End of container-custom -->

    <!-- Footer (From pasted_content.txt) -->
    <footer class="bg-primary-800 text-white py-12">
        <div class="container-custom">
            <div class="grid md:grid-cols-4 gap-8 mb-8">
                <!-- About -->
                <div>
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-10 h-10 bg-accent rounded-full flex items-center justify-center">
                            <i class="fas fa-globe text-white"></i>
                        </div>
                        <div>
                            <span class="text-white font-bold text-xl leading-none">AYEDU</span>
                            <div class="text-xs text-accent-200">AI HUB</div>
                        </div>
                    </div>
                    <p class="text-gray-300 text-sm">
                        Advanced Level තාක්ෂණ විද්‍යා සිසුන් සඳහා AI බලයෙන් යුත් සම්පූර්ණ අධ්‍යාපන පරිසරයක්.
                    </p>
                </div>

                <!-- Quick Links -->
                <div>
                    <h4 class="font-semibold mb-4">ඉක්මන් සබැඳි</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="index.html" class="text-gray-300 hover:text-accent transition-colors">මුල් පිටුව</a></li>
                        <li><a href="#ai-tools-section" class="text-gray-300 hover:text-accent transition-colors">AI මෙවලම්</a></li>
                        <li><a href="#subject-categories" class="text-gray-300 hover:text-accent transition-colors">විෂය කාණ්ඩ</a></li>
                        <li><a href="#resource-library" class="text-gray-300 hover:text-accent transition-colors">සම්පත් පුස්තකාලය</a></li>
                    </ul>
                </div>

                <!-- Resources -->
                <div>
                    <h4 class="font-semibold mb-4">සම්පත්</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="javascript:void(0)" class="text-gray-300 hover:text-accent transition-colors">ඉගෙනුම් පුවරුව</a></li>
                        <li><a href="javascript:void(0)" class="text-gray-300 hover:text-accent transition-colors">සජීවී පන්ති</a></li>
                        <li><a href="javascript:void(0)" class="text-gray-300 hover:text-accent transition-colors">අධ්‍යයන කණ්ඩායම්</a></li>
                        <li><a href="javascript:void(0)" class="text-gray-300 hover:text-accent transition-colors">උපදේශන</a></li>
                    </ul>
                </div>

                <!-- Contact -->
                <div>
                    <h4 class="font-semibold mb-4">සම්බන්ධ වන්න</h4>
                    <ul class="space-y-2 text-sm text-gray-300">
                        <li class="flex items-center gap-2">
                            <i class="fas fa-envelope text-accent"></i>
                            info@ayeduaihub.lk
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-phone text-accent"></i>
                            +94 11 234 5678
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-map-marker-alt text-accent"></i>
                            කොළඹ, ශ්‍රී ලංකාව
                        </li>
                    </ul>
                    <div class="flex gap-3 mt-4">
                        <a href="javascript:void(0)" class="w-8 h-8 bg-primary-700 rounded-full flex items-center justify-center hover:bg-accent transition-colors">
                            <i class="fab fa-facebook-f text-sm"></i>
                        </a>
                        <a href="javascript:void(0)" class="w-8 h-8 bg-primary-700 rounded-full flex items-center justify-center hover:bg-accent transition-colors">
                            <i class="fab fa-youtube text-sm"></i>
                        </a>
                        <a href="javascript:void(0)" class="w-8 h-8 bg-primary-700 rounded-full flex items-center justify-center hover:bg-accent transition-colors">
                            <i class="fab fa-whatsapp text-sm"></i>
                        </a>
                </div>
            </div>
        </div>

            <div class="border-t border-primary-700 pt-8 text-center text-sm text-gray-400">
                <p>© 2025 AYEDU AI HUB. සියලුම හිමිකම් ඇවිරිණි.</p>
            </div>
        </div>
    </footer>

    <!-- AI Tool Modal (From original index.html) -->
    <div id="aiToolModal" class="modal">
        <div class="modal-content-custom">
            <div class="p-4 flex justify-between items-center border-b border-gray-200">
                <h2 id="modalTitle" class="text-xl font-bold text-gray-800">AI Tool Name</h2>
                <button onclick="closeToolModal()" class="text-gray-500 hover:text-gray-800 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="toolContent" class="flex-grow overflow-hidden">
                <!-- Tool specific content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Floating Quick Access Toolbar (From pasted_content.txt) -->
    <div class="fixed bottom-6 right-6 z-50 flex flex-col gap-3">
        <button onclick="window.location.href='#ai-tools-section'" class="w-14 h-14 bg-primary rounded-full shadow-xl flex items-center justify-center text-white hover:scale-110 transition-transform" title="AI මෙවලම්">
            <i class="fas fa-brain text-xl"></i>
        </button>
        <button onclick="window.location.href='#learning-dashboard'" class="w-14 h-14 bg-accent rounded-full shadow-xl flex items-center justify-center text-white hover:scale-110 transition-transform" title="ඉගෙනුම් පුවරුව">
            <i class="fas fa-chart-line text-xl"></i>
        </button>
        <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="w-14 h-14 bg-secondary rounded-full shadow-xl flex items-center justify-center text-white hover:scale-110 transition-transform" title="ඉහළට යන්න">
            <i class="fas fa-arrow-up text-xl"></i>
        </button>
    </div>

    <!-- AI Tool Logic Script (From original index.html - FULL CONTENT) -->
    <script>
        // --- Configuration ---
        const GEMINI_API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent";
        const API_KEY = "AIzaSyA8vfPW4NXHvLl-N5VhnT0iV4JCU0UDpuE"; // මෙහි ඔබේ Gemini API Key ඇතුළත් කරන්න
        let currentTool = null;
        let isLoading = false;
        let chatHistory = [];

        // --- AI Tool Definitions (Crucial for functionality) ---
        const AI_TOOLS = [
            { id: 1, name: "AI Chatbot", icon: "fas fa-comments", description: "ක්ෂණික පිළිතුරු සහ පැහැදිලි කිරීම් ලබා ගන්න.", type: "CHAT", color: "#3498db", model: "gemini-2.5-flash-preview-09-2025", systemPrompt: "ඔබ AYEDU නමින් හඳුන්වන විශේෂයෙන් Advanced Level Technology විෂය ධාරාව සඳහා සහාය වන AI සහායකයෙකි. පරිශීලකයා වෙනස් බසකින් ඉල්ලා සිටී නම් හැර, සිංහලෙන් පිළිතුරු දෙන්න. පිළිතුරු කෙටි හා අධ්‍යාපනික විය යුතුය." },
            { id: 2, name: "සාරාංශකරණය", icon: "fas fa-file-alt", description: "දිගු පාඨ කෙටි සාරාංශ බවට පත් කරන්න.", type: "SUMMARIZER", color: "#2ecc71", model: "gemini-2.5-flash-preview-09-2025", systemPrompt: "ඔබ විශේෂඥ සාරාංශකරණ මෙවලමකි. ලබාදුන් පාඨය සිංහලෙන් 3-5 ප්‍රධාන ලක්ෂණ ලෙස සාරාංශ කරන්න. මුල් සන්දර්භය ආරක්ෂා කරන්න." },
            { id: 3, name: "සංකල්ප පැහැදිලි කිරීම", icon: "fas fa-brain", description: "ඕනෑම සංකීර්ණ සංකල්පයක් සරලව තේරුම් ගන්න.", type: "CONCEPT", color: "#f39c12", model: "gemini-2.5-flash-preview-09-2025", systemPrompt: "ඔබ විශේෂඥ අධ්‍යාපනඥයෙක්. දෙන ලද සංකල්පය සරල, තේරුම් ගත හැකි සිංහලෙන්, සුදුසු උපමාවක් හෝ උදාහරණයක් භාවිතා කරමින් පැහැදිලි කරන්න." },
            { id: 4, name: "කේත සහායක", icon: "fas fa-code", description: "කේත ලියන්න, දෝෂ නිවැරදි කරන්න, සහ පැහැදිලි කිරීම් ලබා ගන්න.", type: "CODE", color: "#e74c3c", model: "gemini-2.5-flash-preview-09-2025", systemPrompt: "ඔබ කේත සහායකයෙක්. ඉල්ලූ භාෂාවෙන් පිරිසිදු, හොඳින් අදහස් දක්වන කේතය සපයන්න, හෝ සපයන ලද කේතය/දෝෂය පැහැදිලි කරන්න. පැහැදිලි කිරීම් සඳහා සිංහල භාවිතා කරන්න සහ කේතය සඳහා ඉංග්‍රීසි භාවිතා කරන්න." },
            { id: 5, name: "ව්‍යාකරණ පරීක්ෂක", icon: "fas fa-spell-check", description: "සිංහල සහ ඉංග්‍රීසි පාඨවල ව්‍යාකරණ දෝෂ නිවැරදි කරන්න.", type: "GRAMMAR", color: "#9b59b6", model: "gemini-2.5-flash-preview-09-2025", systemPrompt: "ඔබ ව්‍යාකරණ සහ අකුරු සම්බන්ධීකරණ පරීක්ෂකයෙක්. ලබාදුන් පාඨයේ ඇති ඕනෑම ව්‍යාකරණ හෝ අකුරු දෝෂ නිවැරදි කරන්න. නිවැරදි කළ පාඨය සහ වෙනස්කම් පිළිබඳ කෙටි පැහැදිලි කිරීම සිංහලෙන් සපයන්න." },
            { id: 6, name: "පරිවර්තකය", icon: "fas fa-language", description: "සිංහල සහ ඉංග්‍රීසි අතර පාඨ පරිවර්තනය කරන්න.", type: "TRANSLATOR", color: "#1abc9c", model: "gemini-2.5-flash-preview-09-2025", systemPrompt: "ඔබ වෘත්තීය පරිවර්තකයෙක්. ලබාදුන් පාඨය නිවැරදිව සහ ස්වාභාවිකව ඉලක්ක භාෂාවට පරිවර්තනය කරන්න." },
            { id: 7, name: "අදහස් උත්පාදක", icon: "fas fa-lightbulb", description: "ව්‍යාපෘති හෝ රචනා සඳහා නව අදහස් ලබා ගන්න.", type: "IDEA", color: "#34495e", model: "gemini-2.5-flash-preview-09-2025", systemPrompt: "ඔබ නිර්මාණශීලී අදහස් උත්පාදකයෙකි. පරිශීලකයාගේ ඉල්ලීම මත පදනම්ව අද්විතීය හා ප්‍රායෝගික අදහස් 5ක් ජනනය කරන්න. ඒවා පැහැදිලිව සිංහලෙන් ලැයිස්තුගත කරන්න." },
            { id: 8, name: "ප්‍රශ්න පත්‍ර උත්පාදක", icon: "fas fa-question-circle", description: "ඕනෑම මාතෘකාවක් සඳහා බහුවරණ ප්‍රශ්න සාදන්න.", type: "QUIZ", color: "#f1c40f", model: "gemini-2.5-flash-preview-09-2025", systemPrompt: "ඔබ ප්‍රශ්නපත්‍ර උත්පාදකයෙකි. පරිශීලකයාගේ ආදානය මත පදනම්ව බහුවරණ ප්‍රශ්න (MCQs) 5ක් සාදන්න. ප්‍රතිදානය JSON වස්තු අරාවක් විය යුතුය, එක් එක් වස්තුවට 'question', 'options' (පේළි අරාව), සහ 'answer' (පේළිය) අඩංගු වේ. ප්‍රශ්න සහ විකල්ප සිංහලෙන් විය යුතුය." },
            { id: 9, name: "රූප උත්පාදක", icon: "fas fa-image", description: "පෙළ විස්තර වලින් රූප සාදන්න.", type: "IMAGE", color: "#e67e22", model: "gemini-2.5-flash-preview-09-2025", systemPrompt: "ඔබ රූප ජනනය කිරීමේ ඉල්ලීම වැඩිදියුණු කරන්නා. පරිශීලකයාගේ ඉල්ලීම රූප ජනනය කිරීමේ ආකෘතියක් සඳහා විස්තරාත්මක, උසස් තත්ත්වයේ ඉල්ලීමක් බවට පරිවර්තනය කරන්න." },
            { id: 10, name: "ශ්‍රව්‍ය උත්පාදක", icon: "fas fa-volume-up", description: "පෙළ ශ්‍රව්‍ය බවට පත් කරන්න.", type: "AUDIO", color: "#3498db", model: "gemini-2.5-flash-preview-09-2025", systemPrompt: "ඔබ පෙළ-සිට-කථන සහායකයෙකි. ලබාදුන් පාඨය උසස් තත්ත්වයේ ශ්‍රව්‍ය බවට පරිවර්තනය කරන්න." }
        ];

        // --- UI Rendering Functions ---

        function renderAITools() {
            const container = document.getElementById('aiToolButtons');
            container.innerHTML = AI_TOOLS.map(tool => `
                <button class="ai-tool-btn p-4 bg-white rounded-xl shadow-md hover:shadow-lg flex flex-col items-center justify-center text-center border-t-4" 
                        style="border-color: ${tool.color};"
                        onclick="openToolModal(${tool.id})">
                    <i class="${tool.icon} text-3xl mb-2" style="color: ${tool.color};"></i>
                    <h3 class="text-lg font-semibold text-gray-800">${tool.name}</h3>
                    <p class="text-xs text-gray-500 mt-1">${tool.description}</p>
                </button>
            `).join('');
        }

        function openToolModal(id) {
            currentTool = AI_TOOLS.find(t => t.id === id);
            if (!currentTool) return;

            document.getElementById('modalTitle').textContent = currentTool.name;
            document.getElementById('toolContent').innerHTML = renderToolContent(currentTool);
            document.getElementById('aiToolModal').style.display = 'flex';
            
            // Reset chat history for chat tool
            if (currentTool.type === 'CHAT') {
                chatHistory = [];
                renderChatHistory();
            }
        }

        function closeToolModal() {
            document.getElementById('aiToolModal').style.display = 'none';
            currentTool = null;
        }

        function renderToolContent(currentTool) {
            const loadingHtml = `
                <div id="loadingOverlay" class="absolute inset-0 bg-white/80 backdrop-blur-sm z-50 flex items-center justify-center hidden">
                    <div class="text-center">
                        <i class="fas fa-spinner fa-spin text-4xl mb-3" style="color: ${currentTool.color};"></i>
                        <p class="text-lg font-semibold text-gray-700">AI මෙවලම ක්‍රියාත්මක වෙමින් පවතී...</p>
                    </div>
                </div>
            `;

            // CHAT Tool
            if (currentTool.type === 'CHAT') {
                return `
                    ${loadingHtml}
                    <div class="flex flex-col h-full theme-chat-bg">
                        <div id="chatOutput" class="flex-grow overflow-y-auto p-4 custom-scroll flex flex-col space-y-2">
                            <!-- Chat messages go here -->
                        </div>
                        <div class="p-4 border-t border-gray-200 bg-white flex items-center">
                            <input type="text" id="toolInput" placeholder="ඔබේ පණිවිඩය මෙහි ලියන්න..." 
                                class="flex-grow p-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                                onkeypress="handleEnter(event)">
                            <button onclick="runTool()" class="ml-3 w-10 h-10 rounded-full text-white flex items-center justify-center" style="background-color: ${currentTool.color}">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                `;
            }

            // CODE Tool
            if (currentTool.type === 'CODE') {
                return `
                    ${loadingHtml}
                    <div class="flex flex-col h-full theme-code-bg">
                        <div class="p-4 border-b border-gray-700">
                            <textarea id="toolInput" class="w-full code-input p-3 rounded-lg resize-none h-24" placeholder="කේතය හෝ විස්තරය මෙහි ලියන්න..." onkeypress="handleEnter(event)"></textarea>
                            <div class="flex justify-end mt-2">
                                <button onclick="runTool()" class="px-4 py-2 rounded-lg font-bold text-white shadow hover:shadow-lg transition" style="background-color: ${currentTool.color}"><i class="fas fa-bolt mr-2"></i> ක්‍රියාත්මක කරන්න</button>
                            </div>
                        </div>
                        <div class="flex-grow p-4 overflow-y-auto custom-scroll">
                            <label class="block text-sm font-bold text-gray-400 mb-2">ප්‍රතිඵලය</label>
                            <div id="toolOutput" class="code-output p-3 rounded-lg whitespace-pre-wrap text-sm">කේත ප්‍රතිඵලය මෙහි දිස්වනු ඇත...</div>
                        </div>
                    </div>
                `;
            }

            // TRANSLATOR Tool
            if (currentTool.type === 'TRANSLATOR') {
                return `
                    ${loadingHtml}
                    <div class="flex flex-col h-full theme-paper-bg">
                        <div class="p-6 bg-white border-b border-gray-100">
                            <div class="flex justify-between items-center mb-3">
                                <label class="block text-sm font-bold text-gray-700 uppercase tracking-wide opacity-70">පරිවර්තනය කරන්න</label>
                                <select id="targetLang" class="p-2 border rounded-lg">
                                    <option value="English">ඉංග්‍රීසි වෙත</option>
                                    <option value="Sinhala">සිංහල වෙත</option>
                                </select>
                            </div>
                            <textarea id="toolInput" class="w-full bg-gray-50 border border-gray-200 rounded-xl p-4 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-none h-32 shadow-sm transition" placeholder="පරිවර්තනය කිරීමට අවශ්‍ය පාඨය මෙහි ලියන්න..."></textarea>
                            <div class="flex justify-end mt-3">
                                <button onclick="runTool()" class="px-6 py-2 rounded-lg font-bold text-white shadow hover:shadow-lg transition transform hover:-translate-y-0.5" style="background-color: ${currentTool.color}"><i class="fas fa-bolt mr-2"></i> පරිවර්තනය කරන්න</button>
                            </div>
                        </div>
                        <div class="flex-grow p-6 overflow-y-auto custom-scroll bg-white">
                            <label class="block text-sm font-bold text-gray-700 mb-4 uppercase tracking-wide opacity-70">පරිවර්තන ප්‍රතිඵලය</label>
                            <div id="toolOutput" class="prose max-w-none text-gray-800 leading-relaxed"></div>
                        </div>
                    </div>
                `;
            }

            // IDEA Generator Tool
            if (currentTool.type === 'IDEA') {
                return `
                    ${loadingHtml}
                    <div class="flex flex-col h-full theme-sticky-bg">
                        <div class="p-6 bg-white border-b border-gray-100">
                            <label class="block text-sm font-bold text-gray-700 mb-2 uppercase tracking-wide opacity-70">අදහස් උත්පාදනය කරන්න</label>
                            <textarea id="toolInput" class="w-full bg-gray-50 border border-gray-200 rounded-xl p-4 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-none h-24 shadow-sm transition" placeholder="ඔබට අදහස් අවශ්‍ය මාතෘකාව මෙහි ලියන්න..."></textarea>
                            <div class="flex justify-end mt-3">
                                <button onclick="runTool()" class="px-6 py-2 rounded-lg font-bold text-white shadow hover:shadow-lg transition transform hover:-translate-y-0.5" style="background-color: ${currentTool.color}"><i class="fas fa-lightbulb mr-2"></i> අදහස් උත්පාදනය කරන්න</button>
                            </div>
                        </div>
                        <div id="toolOutput" class="flex-grow overflow-y-auto p-8 custom-scroll grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 content-start">
                             <!-- Stickies go here -->
                             <div class="sticky-note opacity-50"><p class="text-center text-gray-500">අදහස් මෙහි ඇලවෙනු ඇත...</p></div>
                        </div>
                    </div>
                `;
            }

            // AUDIO Tool
            if (currentTool.type === 'AUDIO') {
                return `
                    ${loadingHtml}
                    <div class="flex flex-col h-full theme-audio-bg">
                        <div class="p-6 bg-white/10 backdrop-blur-sm border-b border-white/20">
                            <label class="block text-sm font-bold text-white mb-2 uppercase tracking-wide">පෙළ ඇතුලත් කරන්න</label>
                            <textarea id="toolInput" class="w-full bg-white/20 border border-white/30 rounded-xl p-4 focus:ring-2 focus:ring-white focus:border-transparent outline-none resize-none h-32 shadow-sm transition text-white placeholder-white/70" placeholder="ශ්‍රව්‍ය බවට පත් කිරීමට අවශ්‍ය පාඨය මෙහි ලියන්න..."></textarea>
                            <div class="flex justify-end mt-3">
                                <button onclick="runTool()" class="px-6 py-2 rounded-lg font-bold text-white shadow hover:shadow-lg transition transform hover:-translate-y-0.5" style="background-color: ${currentTool.color}"><i class="fas fa-volume-up mr-2"></i> ශ්‍රව්‍ය උත්පාදනය කරන්න</button>
                            </div>
                        </div>
                        <div class="flex-grow p-6 overflow-y-auto custom-scroll flex flex-col items-center justify-center">
                            <label class="block text-sm font-bold text-white mb-4 uppercase tracking-wide">ශ්‍රව්‍ය ප්‍රතිඵලය</label>
                            <div class="audio-visualizer mb-6">
                                <div class="audio-bar" style="animation-delay: 0s;"></div>
                                <div class="audio-bar" style="animation-delay: 0.1s;"></div>
                                <div class="audio-bar" style="animation-delay: 0.2s;"></div>
                                <div class="audio-bar" style="animation-delay: 0.3s;"></div>
                                <div class="audio-bar" style="animation-delay: 0.4s;"></div>
                            </div>
                            <div id="toolOutput" class="text-white text-center max-w-lg"></div>
                        </div>
                    </div>
                `;
            }

            // DEFAULT / TEXT TOOLS (Concept, Summarizer, Grammar, Quiz, Image, etc.)
            return `
                ${loadingHtml}
                <div class="flex flex-col h-full bg-white">
                    <div class="p-6 bg-gray-50 border-b border-gray-100">
                        <label class="block text-sm font-bold text-gray-700 mb-2 uppercase tracking-wide opacity-70">Input</label>
                        <textarea id="toolInput" class="w-full bg-white border border-gray-200 rounded-xl p-4 focus:ring-2 focus:ring-${currentTool.color.replace('#','')} focus:border-transparent outline-none resize-none h-32 shadow-sm transition" placeholder="මෙහි ලියන්න..."></textarea>
                        <div class="flex justify-end mt-3">
                            <button onclick="runTool()" class="px-6 py-2 rounded-lg font-bold text-white shadow hover:shadow-lg transition transform hover:-translate-y-0.5" style="background-color: ${currentTool.color}"><i class="fas fa-bolt mr-2"></i> ක්‍රියාත්මක කරන්න</button>
                        </div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto custom-scroll bg-white">
                        <label class="block text-sm font-bold text-gray-700 mb-4 uppercase tracking-wide opacity-70">Result</label>
                        <div id="toolOutput" class="prose max-w-none text-gray-800 leading-relaxed"></div>
                    </div>
                </div>
            `;
        }

        // --- Logic Handlers (Crucial for functionality) ---

        function handleEnter(e) { if(e.key === 'Enter') runTool(); }

        async function runTool() {
            if (isLoading) return;
            const inputEl = document.getElementById('toolInput');
            const outputEl = document.getElementById('toolOutput');
            const loader = document.getElementById('loadingOverlay');
            
            const text = inputEl ? inputEl.value.trim() : '';
            if (!text && currentTool.type !== 'CHAT') return alert("කරුණාකර යමක් ඇතුළත් කරන්න.");

            // UI Loading State
            isLoading = true;
            if(loader) loader.classList.replace('hidden', 'flex');
            
            try {
                // 1. Image Gen - Not supported
                if (currentTool.type === 'IMAGE') {
                    outputEl.innerHTML = `<div class="text-center p-10 text-red-500 font-bold">⚠️ මෙම පරිසරයේ රූප උත්පාදනය සහාය නොදක්වයි. අනුකූල සේවාවක් භාවිතා කරන්න.</div>`;
                }
                
                // 2. Audio Gen - Not supported
                else if (currentTool.type === 'AUDIO') {
                    outputEl.innerHTML = `<div class="text-center p-10 text-white font-bold">⚠️ මෙම පරිසරයේ ශ්‍රව්‍ය උත්පාදනය සහාය නොදක්වයි. අනුකූල සේවාවක් භාවිතා කරන්න.</div>`;
                }

                // 3. Quiz Gen
                else if (currentTool.type === 'QUIZ') {
                    const result = await generateText(text);
                    const jsonMatch = result.match(/```json\n([\s\S]*?)\n```/);
                    let quizData;
                    if (jsonMatch) {
                        quizData = JSON.parse(jsonMatch[1]);
                    } else {
                        // Fallback: try to parse the whole response if no code block is found
                        quizData = JSON.parse(result);
                    }
                    
                    let html = `<div class="border-b-2 border-black pb-4 mb-6 text-center"><h1 class="text-2xl font-serif font-bold uppercase">විභාග ප්‍රශ්න පත්‍රය</h1></div>`;
                    quizData.forEach((q, i) => {
                        html += `<div class="mb-6"><p class="font-bold mb-2">${i+1}. ${q.question}</p><ul class="pl-5 list-[upper-alpha] space-y-1">${q.options.map(o=>`<li>${o}</li>`).join('')}</ul></div>`;
                    });
                    outputEl.innerHTML = html;
                }

                // 4. Idea Gen (Stickies)
                else if (currentTool.type === 'IDEA') {
                    const result = await generateText(text);
                    const ideas = result.split('\n').filter(i => i.trim().length > 0);
                    outputEl.innerHTML = ideas.map(idea => `<div class="sticky-note"><p class="text-gray-800 text-lg">${idea.replace(/^\d+\.\s*/, '')}</p></div>`).join('');
                }

                // 5. Chat
                else if (currentTool.type === 'CHAT') {
                    const chatOut = document.getElementById('chatOutput');
                    chatOut.innerHTML += `<div class="chat-bubble chat-user">${text}</div>`;
                    inputEl.value = ''; // Clear input immediately
                    chatOut.scrollTop = chatOut.scrollHeight;
                    
                    chatHistory.push({ role: 'user', parts: [{ text }] });
                    const reply = await generateText(null, chatHistory);
                    chatOut.innerHTML += `<div class="chat-bubble chat-ai">${marked.parse(reply)}</div>`;
                    chatHistory.push({ role: 'model', parts: [{ text: reply }] });
                    chatOut.scrollTop = chatOut.scrollHeight;
                }

                // 6. General Text Tools (Essay, Code, Concept, etc.)
                else {
                    let prompt = text;
                    if (currentTool.type === 'TRANSLATOR') {
                        const target = document.getElementById('targetLang').value;
                        prompt = `Translate to ${target}: ${text}`;
                    }
                    
                    const reply = await generateText(prompt);
                    
                    if (currentTool.type === 'CODE') {
                        outputEl.innerHTML = `<pre class="text-sm font-mono whitespace-pre-wrap">${reply}</pre>`;
                        outputEl.classList.remove('hidden');
                    } else {
                        outputEl.innerHTML = marked.parse(reply);
                    }
                }

            } catch (err) {
                alert("දෝෂයක් සිදුවිය: " + err.message);
            } finally {
                isLoading = false;
                if(loader) loader.classList.replace('flex', 'hidden');
            }
        }

        // --- Helper API Functions (Crucial for functionality) ---
        async function generateText(input, history = null) {
            let contents = [];
            
            // Add system instruction
            contents.push({
                role: "user",
                parts: [{ text: currentTool.systemPrompt }]
            });
            
            // Add chat history if available
            if (history && history.length > 0) {
                history.forEach(item => {
                    contents.push({
                        role: item.role,
                        parts: item.parts
                    });
                });
            }
            
            // Add current input
            if (input) {
                contents.push({
                    role: "user",
                    parts: [{ text: input }]
                });
            }
            
            const payload = {
                contents: contents,
                generationConfig: {
                    temperature: 0.7,
                    maxOutputTokens: 2048,
                }
            };
            
            const response = await callGeminiAPI(GEMINI_API_URL, payload);
            return response.candidates[0].content.parts[0].text;
        }

        async function callGeminiAPI(url, payload) {
            const apiUrl = `${url}?key=${API_KEY}`;
            const res = await fetch(apiUrl, { 
                method: 'POST', 
                headers: {
                    'Content-Type': 'application/json',
                }, 
                body: JSON.stringify(payload) 
            });
            
            if (!res.ok) {
                const errorData = await res.json();
                throw new Error(errorData.error?.message || 'API Error');
            }
            
            return await res.json();
        }

        // --- Init and Utility Functions ---
        
        function renderChatHistory() {
            const chatOut = document.getElementById('chatOutput');
            chatOut.innerHTML = `<div class="text-center text-gray-400 text-sm py-4">සංවාදය ආරම්භ කරන්න...</div>`;
        }

        window.onload = function() {
            renderAITools();
            // API Key setup instruction alert
            if (API_KEY === "YOUR_GEMINI_API_KEY_HERE") {
                console.warn("⚠️ කරුණාකර API_KEY විචල්‍යය ඔබේ Gemini API Key එකට වෙනස් කරන්න.");
            }
        };
        
        // Mobile Menu Toggle (From pasted_content.txt)
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }

        // Smooth scroll for anchor links (From pasted_content.txt)
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });
    </script>
</body>
</html>
